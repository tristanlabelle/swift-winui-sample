// Generated by swift-winrt
// swiftlint:disable all

import WindowsRuntime
import WinUI_ABI
import UWP
import WindowsAppSDK


/// Enables custom group style selection logic as a function of the parent group and its level.
open class MicrosoftUIXamlControls_GroupStyleSelector: WindowsRuntime.ComposableClass, @unchecked Sendable {
    /// Initializes a new instance of the GroupStyleSelector class.
    public init() throws {
        try super.init(_compose: Self.self != MicrosoftUIXamlControls_GroupStyleSelector.self) {
            (baseInterface, innerInterface: inout IInspectablePointer?) in
            try Self._igroupStyleSelectorFactory.createInstance(baseInterface, &innerInterface)
        }
    }

    /// Returns a specific GroupStyle for a given group and level.
    /// - Parameter group: The group to return a GroupStyle for.
    /// - Parameter level: The level of nesting for the specified group.
    /// - Returns: TheGroupStyle to use when this GroupStyleSelector is invoked in an application.
    public func selectGroupStyle(_ group: WindowsRuntime.IInspectable?, _ level: Swift.UInt32) throws -> MicrosoftUIXamlControls_GroupStyle {
        try COM.NullResult.unwrap(_igroupStyleSelector.selectGroupStyle(group, level))
    }

    /// When implemented by a derived class, returns a specific GroupStyle for a given group and level.
    /// - Parameter group: The group to return a GroupStyle for.
    /// - Parameter level: The level of nesting for the specified group.
    /// - Returns: The GroupStyle to use for the specified group and level.
    open func selectGroupStyleCore(_ group: WindowsRuntime.IInspectable?, _ level: Swift.UInt32) throws -> MicrosoftUIXamlControls_GroupStyle {
        try COM.NullResult.unwrap(_igroupStyleSelectorOverrides.selectGroupStyleCore(group, level))
    }

    // MARK: Implementation details

    public init(_wrapping inner: consuming COM.COMReference<SWRT_MicrosoftUIXamlControls_IGroupStyleSelector>) {
        super.init(_wrapping: inner.cast()) // Transitively casts down to IInspectable
    }

    public override init<ABIStruct>(_compose: Swift.Bool, _factory: ComposableFactory<ABIStruct>) throws {
        try super.init(_compose: _compose, _factory: _factory)
    }

    private var _lazyIGroupStyleSelector: COM.COMReference<SWRT_MicrosoftUIXamlControls_IGroupStyleSelector>.Optional = .none

    internal var _igroupStyleSelector: COM.COMInterop<SWRT_MicrosoftUIXamlControls_IGroupStyleSelector> {
        get throws {
            try _lazyIGroupStyleSelector.lazyInitInterop {
                try _queryInnerInterface(uuidof(SWRT_MicrosoftUIXamlControls_IGroupStyleSelector.self)).cast()
            }
        }
    }

    private var _lazyIGroupStyleSelectorOverrides: COM.COMReference<SWRT_MicrosoftUIXamlControls_IGroupStyleSelectorOverrides>.Optional = .none

    internal var _igroupStyleSelectorOverrides: COM.COMInterop<SWRT_MicrosoftUIXamlControls_IGroupStyleSelectorOverrides> {
        get throws {
            try _lazyIGroupStyleSelectorOverrides.lazyInitInterop {
                try _queryInnerInterface(uuidof(SWRT_MicrosoftUIXamlControls_IGroupStyleSelectorOverrides.self)).cast()
            }
        }
    }

    private static var _lazyIActivationFactory: COM.COMReference<SWRT_IActivationFactory>.Optional = .init()

    private static var _iactivationFactory: COM.COMInterop<SWRT_IActivationFactory> {
        get throws {
            try _lazyIActivationFactory.lazyInitInterop {
                try WindowsRuntime.activationFactoryResolver.resolve(runtimeClass: "Microsoft.UI.Xaml.Controls.GroupStyleSelector")
            }
        }
    }

    private static var _lazyIGroupStyleSelectorFactory: COM.COMReference<SWRT_MicrosoftUIXamlControls_IGroupStyleSelectorFactory>.Optional = .none

    internal static var _igroupStyleSelectorFactory: COM.COMInterop<SWRT_MicrosoftUIXamlControls_IGroupStyleSelectorFactory> {
        get throws {
            try _lazyIGroupStyleSelectorFactory.lazyInitInterop {
                try _iactivationFactory.queryInterface(uuidof(SWRT_MicrosoftUIXamlControls_IGroupStyleSelectorFactory.self)).cast()
            }
        }
    }

    // MARK: Override support

    private var _igroupStyleSelectorOverrides_outer: COM.COMEmbedding = .uninitialized

    public override func _queryOverridesInterface(_ id: COM.COMInterfaceID) throws -> COM.IUnknownReference.Optional {
        if id == uuidof(SWRT_MicrosoftUIXamlControls_IGroupStyleSelectorOverrides.self) {
            if !_igroupStyleSelectorOverrides_outer.isInitialized {
                _igroupStyleSelectorOverrides_outer.initialize(embedder: self,
                    virtualTable: &MicrosoftUIXamlControls_GroupStyleSelectorBinding.VirtualTables.igroupStyleSelectorOverrides)
            }
            return .init(_igroupStyleSelectorOverrides_outer.toCOM())
        }
        return .none
    }
}